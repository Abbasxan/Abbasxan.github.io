<!DOCTYPE html>
<html lang="az">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>X v…ô 0 (Tic-Tac-Toe) | Neon Sultan</title>
  <link rel="stylesheet" href="../assets/css/style.css" />
  <style>
    body {
      background: radial-gradient(ellipse at 60% 15%, #495082 0%, #181924 100%);
      min-height: 100vh;
    }
    .ttt-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-top: 48px;
      background: rgba(24,25,36,0.96);
      border-radius: 18px;
      padding: 36px 32px 32px 32px;
      box-shadow: 0 10px 44px #000b;
      max-width: 410px;
      margin-left: auto;
      margin-right: auto;
    }
    .ttt-title {
      font-size: 2em;
      color: #61dafb;
      margin-bottom: 8px;
      text-shadow: 0 2px 12px #222b;
    }
    .ttt-mode-row {
      margin-bottom: 16px;
      display: flex;
      justify-content: center;
      gap: 16px;
    }
    .ttt-mode-btn {
      background: linear-gradient(90deg,#61dafb,#fbbd23);
      color: #222;
      border: none;
      border-radius: 9px;
      font-weight: bold;
      font-size: 1em;
      padding: 7px 20px;
      cursor: pointer;
      box-shadow: 0 2px 8px #0004;
      transition: .16s;
    }
    .ttt-mode-btn.active, .ttt-mode-btn:focus {
      background: linear-gradient(90deg,#fbbd23,#61dafb);
      color: #fff;
      outline: 2px solid #fbbd23;
    }
    .ttt-board {
      display: grid;
      grid-template-columns: repeat(3,80px);
      grid-template-rows: repeat(3,80px);
      gap: 12px;
      margin-top: 24px;
      margin-bottom: 14px;
    }
    .ttt-cell {
      width: 80px;
      height: 80px;
      font-size: 2.5em;
      background: #fcf6e3;
      color: #e53935;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      border-radius: 13px;
      box-shadow: 0 2px 8px #0003;
      user-select: none;
      transition: background .2s, color .2s, box-shadow .2s;
      border: 2.5px solid #2d3250;
      font-family: 'Inter', Arial, sans-serif;
      font-weight: bold;
      position: relative;
    }
    .ttt-cell.o { color: #1e88e5; }
    .ttt-cell.x { color: #e53935; }
    .ttt-cell:hover:not(.disabled):not(.won) {
      background: #fffbe7;
      outline: 2.5px solid #61dafb;
      color: #00bcd4;
      z-index: 2;
    }
    .ttt-cell.disabled {
      cursor: default;
      opacity: 0.7;
    }
    .ttt-cell.won {
      background: #fbbd23;
      color: #222;
      box-shadow: 0 0 24px #fbbd23cc, 0 0 18px #61dafb99;
      border-color: #fbbd23;
      animation: blink 1s infinite alternate;
    }
    @keyframes blink {
      from { box-shadow: 0 0 18px #fbbd2377; }
      to { box-shadow: 0 0 28px #61dafbcc; }
    }
    .ttt-status {
      margin-top: 14px;
      font-size: 1.18em;
      color: #fff;
      min-height: 32px;
      text-shadow: 0 2px 8px #2229;
      text-align: center;
    }
    .ttt-btn {
      margin-top: 17px;
      padding: 10px 24px;
      font-size: 1em;
      border-radius: 9px;
      border: none;
      background: linear-gradient(90deg,#61dafb,#fbbd23);
      color: #222;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 2px 8px #0004;
      transition: background .2s, color .2s, transform .12s;
    }
    .ttt-btn:hover {
      background: linear-gradient(90deg,#fbbd23,#61dafb);
      color: #fff;
      transform: translateY(-2px) scale(1.07);
    }
    .ttt-btn.secondary {
      background: #222;
      color: #fff;
      margin-top: 10px;
    }
    .ttt-names {
      margin: 0 0 8px 0;
      font-size: 1.1em;
      color: #fbbd23;
      text-shadow: 0 2px 8px #2227;
      display: flex;
      justify-content: space-between;
      width: 270px;
      max-width: 93vw;
    }
    .ttt-controls-mobile {
      display: none;
      margin-top: 14px;
      width: 100%;
      max-width: 320px;
      justify-content: center;
      gap: 12px;
      flex-wrap: wrap;
    }
    .ttt-controls-mobile button {
      background: #23233b;
      color: #fbbd23;
      font-size: 1.7em;
      border: none;
      border-radius: 11px;
      width: 54px; height: 54px;
      margin: 2px;
      box-shadow: 0 2px 10px #0007;
      display: flex;
      align-items: center;
      justify-content: center;
      user-select: none;
      touch-action: manipulation;
      transition: background .13s, color .13s;
    }
    .ttt-controls-mobile button:active, .ttt-controls-mobile button.active { background: #fbbd23; color: #23233b; }
    @media (max-width: 600px) {
      .ttt-container { padding: 14px 3vw 14px 3vw;}
      .ttt-title { font-size: 1.35em;}
      .ttt-board { grid-template-columns: repeat(3,24vw); grid-template-rows: repeat(3,24vw);}
      .ttt-names { width: 99vw;}
      .ttt-controls-mobile{display:flex;}
      .ttt-btn {font-size:0.98em;}
    }
  </style>
</head>
<body>
  <nav class="navbar modern-navbar">
    <div class="container">
      <div class="logo">Neon Sultan</div>
      <ul class="nav-links" id="navLinks">
        <li><a href="../index.html">Ana S…ôhif…ô</a></li>
        <li><a href="../about.html">Haqqƒ±mda</a></li>
        <li><a href="../projects.html">Proyektl…ôrim</a></li>
        <li><a href="../license.html">Lisenziya</a></li>
        <li><a href="../contact.html">∆èlaq…ô</a></li>
        <li><a href="../oyunlar.html" class="active">Oyunlar</a></li>
      </ul>
    </div>
  </nav>
  <main class="ttt-container">
    <div class="ttt-title">X v…ô 0 (Tic-Tac-Toe)</div>
    <div class="ttt-mode-row">
      <button id="modePVP" class="ttt-mode-btn active" onclick="setMode('pvp')">2 n…ôf…ôr</button>
      <button id="modeAI" class="ttt-mode-btn" onclick="setMode('ai')">NEON AI</button>
    </div>
    <div class="ttt-names" id="tttNames">
      <span id="p1Name">Oyun√ßu 1 (X)</span>
      <span id="p2Name">Oyun√ßu 2 (O)</span>
    </div>
    <div class="ttt-board" id="tttBoard"></div>
    <div class="ttt-controls-mobile" id="tttMobileControls">
      <button id="btnUp" aria-label="Yuxarƒ±">&#8593;</button>
      <button id="btnLeft" aria-label="Sol">&#8592;</button>
      <button id="btnMark" aria-label="Qoy">‚úîÔ∏è</button>
      <button id="btnRight" aria-label="Saƒü">&#8594;</button>
      <button id="btnDown" aria-label="A≈üaƒüƒ±">&#8595;</button>
    </div>
    <div class="ttt-status" id="tttStatus"></div>
    <button class="ttt-btn" onclick="tttReset()">Yenid…ôn ba≈üla</button>
    <a href="../oyunlar.html" class="ttt-btn secondary">‚Üê Oyunlara qayƒ±t</a>
  </main>
  <footer class="footer">
    <p>¬© 2025 Sultan. Neon Group Azerbaijan | <a href="../license.html">Lisenziya</a></p>
  </footer>
  <script>
    let mode = 'pvp'; // 'pvp' or 'ai'
    let board = Array(9).fill('');
    let current = 'X';
    let playing = true;
    let winLine = [];
    let aiThinking = false;
    let selectedCell = 0; // 0-8

    const tttBoard = document.getElementById("tttBoard");
    const tttStatus = document.getElementById("tttStatus");
    const tttNames = document.getElementById("tttNames");
    const p1Name = document.getElementById("p1Name");
    const p2Name = document.getElementById("p2Name");
    const modePVP = document.getElementById("modePVP");
    const modeAI = document.getElementById("modeAI");

    function setMode(newMode) {
      mode = newMode;
      modePVP.classList.toggle('active', mode==='pvp');
      modeAI.classList.toggle('active', mode==='ai');
      if (mode==='pvp') {
        p1Name.textContent = "Oyun√ßu 1 (X)";
        p2Name.textContent = "Oyun√ßu 2 (O)";
      } else {
        p1Name.textContent = "S…ôn (X)";
        p2Name.innerHTML = '<span style="color:#61dafb;">NEON AI (O)</span>';
      }
      tttReset();
    }

    function render() {
      tttBoard.innerHTML = '';
      for (let i=0; i<9; i++) {
        const d = document.createElement('div');
        d.className = "ttt-cell";
        if (board[i] === 'O') d.classList.add('o');
        if (board[i] === 'X') d.classList.add('x');
        d.textContent = board[i];
        if (board[i] || !playing || aiThinking) d.classList.add('disabled');
        if (winLine.includes(i)) d.classList.add('won');
        if (selectedCell === i && playing && !aiThinking && /Android|iPhone|iPad|iPod|Mobile/i.test(navigator.userAgent))
          d.style.boxShadow = "0 0 0 3.5px #61dafb, 0 2px 8px #0003";
        d.onclick = () => tttMove(i);
        tttBoard.appendChild(d);
      }
      // Status
      if (!playing) {
        aiThinking = false;
        if (winLine.length > 0) {
          const winner = board[winLine[0]];
          if (mode === 'ai' && winner === 'O') {
            tttStatus.innerHTML = `<b>NEON AI qalib oldu!</b> ü§ñ`;
          } else if (mode === 'ai' && winner === 'X') {
            tttStatus.innerHTML = `<b>S…ôn qalib oldun!</b> üéâ`;
          } else {
            tttStatus.innerHTML = `<b>${winner} qalib oldu!</b>`;
          }
        } else {
          tttStatus.textContent = "He√ß-he√ß…ô!";
        }
      } else {
        if (mode === 'ai') {
          tttStatus.innerHTML = current === 'X'
            ? '<b>S…ônin n√∂vb…ôn (X)</b>'
            : '<span style="color:#61dafb;">NEON AI d√º≈ü√ºn√ºr...</span>';
        } else {
          tttStatus.textContent = `Sƒ±ra: ${current === 'X' ? "Oyun√ßu 1 (X)" : "Oyun√ßu 2 (O)"}`;
        }
      }
    }

    function tttMove(i) {
      if (!playing || board[i] || (mode==='ai' && current==='O') || aiThinking) return;
      board[i] = current;
      if (tttCheck(current)) {
        playing = false;
        render();
        return;
      }
      if (board.every(cell=>cell)) {
        playing = false;
        render();
        return;
      }
      current = current === 'X' ? 'O' : 'X';
      render();
      if (mode==='ai' && current==='O' && playing) {
        aiThinking = true;
        tttStatus.innerHTML = '<span style="color:#61dafb;">NEON AI d√º≈ü√ºn√ºr...</span>';
        setTimeout(aiMove, 500 + Math.random()*350);
      }
    }

    function tttCheck(p) {
      const w = [
        [0,1,2],[3,4,5],[6,7,8],
        [0,3,6],[1,4,7],[2,5,8],
        [0,4,8],[2,4,6]
      ];
      for (let line of w) {
        if (line.every(i=>board[i]===p)) {
          winLine = line;
          return true;
        }
      }
      return false;
    }

    function tttReset() {
      board = Array(9).fill('');
      current = 'X';
      playing = true;
      winLine = [];
      aiThinking = false;
      selectedCell = firstFreeCell();
      render();
      if (mode==='ai' && current==='O') {
        aiThinking = true;
        setTimeout(aiMove, 450);
      }
    }

    function aiMove() {
      if (!playing) { aiThinking=false; return; }
      let move;
      if (Math.random() < 0.25) {
        const free = board.map((v,i)=>v==''?i:null).filter(i=>i!==null);
        move = free[Math.floor(Math.random()*free.length)];
      } else {
        move = bestMove();
      }
      board[move] = 'O';
      if (tttCheck('O')) {
        playing = false;
        aiThinking = false;
        render();
        return;
      }
      if (board.every(cell=>cell)) {
        playing = false;
        aiThinking = false;
        render();
        return;
      }
      current = 'X';
      aiThinking = false;
      render();
    }

    function bestMove() {
      let bestScore = -Infinity;
      let move;
      for (let i=0;i<9;i++) {
        if (board[i]==='') {
          board[i]='O';
          let score = minimax(board, 0, false);
          board[i]='';
          if (score > bestScore) {
            bestScore = score;
            move = i;
          }
        }
      }
      return move;
    }
    function minimax(b, depth, isMax) {
      if (win(b,'O')) return 10-depth;
      if (win(b,'X')) return depth-10;
      if (b.every(cell=>cell)) return 0;
      if (isMax) {
        let best = -Infinity;
        for(let i=0;i<9;i++){
          if(b[i]===''){
            b[i]='O';
            best = Math.max(best, minimax(b, depth+1, false));
            b[i]='';
          }
        }
        return best;
      } else {
        let best = Infinity;
        for(let i=0;i<9;i++){
          if(b[i]===''){
            b[i]='X';
            best = Math.min(best, minimax(b, depth+1, true));
            b[i]='';
          }
        }
        return best;
      }
    }
    function win(b, p) {
      const w = [
        [0,1,2],[3,4,5],[6,7,8],
        [0,3,6],[1,4,7],[2,5,8],
        [0,4,8],[2,4,6]
      ];
      for (let line of w) if (line.every(i=>b[i]===p)) return true;
      return false;
    }

    function setupMobileControls() {
      const left = document.getElementById('btnLeft');
      const right = document.getElementById('btnRight');
      const up = document.getElementById('btnUp');
      const down = document.getElementById('btnDown');
      const mark = document.getElementById('btnMark');
      left.ontouchstart = left.onmousedown = ()=>{ moveSelection(-1,0); };
      right.ontouchstart = right.onmousedown = ()=>{ moveSelection(1,0); };
      up.ontouchstart = up.onmousedown = ()=>{ moveSelection(0,-1); };
      down.ontouchstart = down.onmousedown = ()=>{ moveSelection(0,1); };
      mark.ontouchstart = mark.onmousedown = ()=>{ markSelectedCell(); };
    }

    // dirX: -1 (left), 1 (right), dirY: -1 (up), 1 (down)
    function moveSelection(dirX, dirY) {
      if (!playing || aiThinking) return;
      let row = Math.floor(selectedCell/3);
      let col = selectedCell%3;
      let nextIdx = selectedCell;
      let tries = 0;
      do {
        if(dirX!==0){
          col = (col+dirX+3)%3;
        }
        if(dirY!==0){
          row = (row+dirY+3)%3;
        }
        nextIdx = row*3+col;
        tries++;
      } while(board[nextIdx] && tries<9);
      selectedCell = nextIdx;
      render();
    }

    function getFreeCells() {
      let arr = [];
      for(let i=0;i<9;i++) if(!board[i]) arr.push(i);
      return arr;
    }
    function firstFreeCell() {
      let arr = getFreeCells();
      return arr.length ? arr[0] : 0;
    }
    function markSelectedCell() {
      if (!playing || aiThinking) return;
      if (board[selectedCell] === '') tttMove(selectedCell);
      else {
        // –ê–≤—Ç–æ–ø–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–π —Å–≤–æ–±–æ–¥–Ω–æ–π
        let free = getFreeCells();
        if (free.length) {
          selectedCell = free[0];
          render();
        }
      }
    }
    // –°–≤–∞–π–ø—ã: –≤–ª–µ–≤–æ/–≤–ø—Ä–∞–≤–æ/–≤–≤–µ—Ä—Ö/–≤–Ω–∏–∑ ‚Äî –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ, —Ç–∞—á –≤–Ω–∏–∑ ‚Äî –ø–æ—Å—Ç–∞–≤–∏—Ç—å
    let touchStartX = 0, touchStartY = 0;
    tttBoard.addEventListener('touchstart', function(e){
      if(e.touches.length===1){
        touchStartX = e.touches[0].clientX;
        touchStartY = e.touches[0].clientY;
      }
    });
    tttBoard.addEventListener('touchend', function(e){
      if(e.changedTouches.length===1){
        let dx = e.changedTouches[0].clientX - touchStartX;
        let dy = e.changedTouches[0].clientY - touchStartY;
        if(Math.abs(dx)>30 && Math.abs(dx)>Math.abs(dy)){
          if(dx>0) moveSelection(1,0);
          else moveSelection(-1,0);
        } else if(Math.abs(dy)>30 && Math.abs(dy)>Math.abs(dx)){
          if(dy>0) moveSelection(0,1);
          else moveSelection(0,-1);
        } else if(Math.abs(dy)<=30 && Math.abs(dx)<=30) {
          markSelectedCell();
        }
      }
    });
    setupMobileControls();
    setMode(mode);
  </script>
</body>
</html>
